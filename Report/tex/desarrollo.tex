\section{Modelo Matemático}

Para describir al sistema es necesario obtener las ecuaciones 
de movimiento del péndulo simple. 
Estas ecuaciones permiten 
determinar su estado para cualquier 
instante de tiempo, tomando en cuenta las condiciones 
iniciales del mismo. 
La posición del péndulo simple se refiere a 
las coordenadas  $\{x, y\} \in R^2$  medidas respecto a un marco 
referencial inercial\footnote{Se define como marco 
referencial inercial a todo marco referencial que no 
experimente aceleraciones.} 
que determinan la ubicación de 
la masa puntual \emph{m} en el espacio.
La posición del péndulo se restringe a ser bidimensional
ya que se asume que el movimiento del sistema está restringido a un plano
cuya coordenada \emph{z} es cero.

Se emplean tres formulaciones para obtener las ecuaciones 
de movimiento para el sistema:
\begin{itemize}
 \item Mecánica Newtoniana. Utilizando el método de balanceo de torques.
 \item Mecánica Lagrangiana. Basada en la ecuación de Euler-Lagrange.
 \item Mecánica Hamiltoniana. Utilizando coordenadas y momentos generalizados.
\end{itemize}



%  --------------------------
%  Newton's Laws of Motion
% ---------------------------

\subsection{Mecánica Newtoniana}

Las coordenadas del sistema pueden ser expresadas como funciones
de la siguiente manera:

\begin{equation}
 \begin{pmatrix}
 x(\theta)\\
 y(\theta)
 \end{pmatrix}
 = \begin{pmatrix}
 l \sin (\theta)\\
 l \cos (\theta)
 \end{pmatrix}
 \label{eq: system coordinates}
\end{equation}

Empleando las leyes de movimiento de Newton, 
se establece que la aceleración ($\bold{a}$) que el objeto
experimenta está determinada por el
efecto combinado de las fuerzas que actúan sobre el mismo.
De igual manera, esta relación puede ser representada por
el cambio de momento angular del sistema respecto al 
marco de referencia $\Sigma_0$.

Como se observa en la figura \ref{fig: pendulum forces}, 
para el caso de un péndulo simple 
hay dos vectores de fuerza presentes en el sistema:
la fuerza de gravedad ($\bold{F}_{mg} = m\bold{g}$) que actúa paralelo al eje vertical 
y la fuerza de fricción ($\bold{F}_f = kl\dot{\theta}$) que se opone al movimiento del objeto. 

Debido al movimiento circular que el péndulo experimenta,
es preferible expresar el efecto combinado
de las fuerzas que actúan en el sistema como
la sumatoria de los torques que éstas fuerzas
efectúan sobre el sistema con respecto al marco de
referencia inercial.

\begin{equation}
 \begin{split}
  \sum\boldsymbol{\tau} & = \sum (\bold{l} \times \bold{F})\\
  & = I \boldsymbol{\alpha}
 \end{split}
 \label{eq: sum of moments pendulum}
\end{equation}

La variable de interés es el escalar $\theta$, por ello
se replantea la ecuación \eqref{eq: sum of moments pendulum}
como la suma de las magnitudes de los momentos.
Esta magnitud se expresa de la siguiente manera:

\begin{equation}
 \tau =  \langle \, \bold{l} , \bold{F}\rangle=  l F \sin(\phi) \qquad 
\end{equation}

En donde $\phi$ es el ángulo entre los vectores de posición y fuerza. 
Para los vectores de fuerza de gravedad y fricción,
solamente los componentes ortogonales al vector de posición generan
un torque sobre el objeto, por lo que la expresión anterior se reduce a 
$\tau = l F_\bot$.

Retomando la ecuación \eqref{eq: sum of moments pendulum}, considerando 
que el momento de inercia respecto al marco referencial para una partícula es 
el producto de la masa y el cuadrado de la distancia ($ I = m l^2$):

\begin{equation}
\begin{split}
 \sum \tau &= l F_{mg\bot}  + l F_f\\
 & = l (-m g \sin(\theta))  + l (k l \dot{\theta})\\
 & = I \alpha \\
 & = (m l^2) \ddot{\theta}
 \end{split}
 \label{eq: sum of moments magnitude}
\end{equation}

Se resuelve \eqref{eq: sum of moments magnitude} para $\ddot{\theta}$


\begin{equation}
\begin{split}
 (m l^2) \ddot{\theta} &= l (-m g \sin(\theta))  + l (k l \dot{\theta})\\
 &= - mgl \sin(\theta) + kl^2 \dot{\theta}\\
 \ddot{\theta} &= - \dfrac{g}{l} \sin(\theta) + \dfrac{k}{m} \dot{\theta}
\end{split}
 \label{eq: angular acceleration newton}
\end{equation}


\subsection{Mecánica Lagrangiana}

El método de conservación de energía del sistema se sustenta
en la ecuación de Euler-Lagrange \eqref{eq: euler lagrange equation}, 
la cual describe que para un sistema dado la 
energía total del sistema permanece constante.
Es imperativo obtener las ecuaciones de energía del péndulo
para poder determinar las ecuaciones de movimiento del sistema.

Se establece un marco de referencia inercial en la ubicación de
la masa puntual en la que la posición angular del mismo sea cero.
Con este marco referencial, las coordenadas de posición se expresan
así: 

\begin{equation}
\begin{pmatrix}
x(\theta)\\
y(\theta)
\end{pmatrix}
= 
\begin{pmatrix}
l\sen(\theta)\\
l(1 - \cos(\theta)
\end{pmatrix}
\label{eq: lagrange position coordinates}
\end{equation}


Retomando la función del Lagrangiano \eqref{eq: lagrangian}, 
es necesario definir la energía potencial del sistema.
Para el caso del péndulo simple que se está analizando, 
la energía potencial del sistema se expresa de la siguiente manera.

\begin{equation}
 V(\theta) = m g l ( 1 - \cos (\theta) )
 \label{V_equ}
\end{equation}

Para el péndulo simple, la ecuación de energía cinética considera
la velocidad en ambos ejes.

\begin{equation} 
T = \frac{1}{2}m(\dot{x}^2 + \dot{y}^2) 
\label{eq: T_equ}
\end{equation}

Se obtienen expresiones para la primer derivada respecto al tiempo de 
las coordenadas $\{x, y\}$ en función de $\theta$.

\begin{equation} 
\begin{pmatrix}
\dot{x}\\
\dot{y}
\end{pmatrix}
= 
\begin{pmatrix}
l\dot{\theta}\cos(\theta)\\
l\dot{\theta}\sen(\theta)
\end{pmatrix}
\label{eq: Vel_p}
\end{equation}


Substituyendo la ecuación \eqref{eq: Vel_p} en \eqref{eq: T_equ}, 
se plantea la ecuación de la energía cinética en función de $\theta$.

\begin{equation}
T = \frac{1}{2}ml^2\dot{\theta}^2
\end{equation}


Se designa a $\theta$ como la coordenada generalizada $q$ del sistema y
se plantea la función del Lagrangiano.


\begin{equation}
   \mathcal L = \dfrac{1}{2}m l^2 \dot{\theta}^2 - m g l (1 - \cos{\theta})
 \label{eq: pendulum lagrangian}
\end{equation}

Se obtienen las derivadas parciales del Lagrangiano para la ecuación de 
Euler-Lagrange.

\begin{subequations}
\begin{align}
  \dfrac{\partial \mathcal L}{\partial \theta} &= - m g l \sin{\theta} \\
  \dfrac{\partial \mathcal L}{\partial \dot{\theta}} &= m l ^2 \dot{\theta}\\
  \dfrac{d}{dt}\dfrac{\partial \mathcal L}{\partial \dot{\theta}} &= ml^2\ddot{\theta}
  \end{align}
 \label{eq: partial derivatives lagrangian}
\end{subequations}


Substiyendo \eqref{eq: partial derivatives lagrangian} 
en \eqref{eq: euler lagrange equation}
se obtiene la ecuación de Euler-Lagrange para el sistema.

\begin{equation}
 ml^2\ddot{\theta} + m g l \sin(\theta) = 0
 \label{eq: euler lagrange pendulum}
\end{equation}

Se resuelve \eqref{eq: euler lagrange pendulum} para $\ddot{\theta}$.

\begin{equation}
 \ddot{\theta} = - \dfrac{g}{l} \sin (\theta)
 \label{eq: angular acceleration lagrange}
\end{equation}


Se observa que para el caso sin fricción ($k = 0$), las ecuaciones 
\eqref{eq: angular acceleration newton} y 
\eqref{eq: angular acceleration lagrange}
son idénticas.


\subsection{Mecánica Hamiltoniana}

Dado que las coordenadas $\{x, y\}$ son ambas funciones de $\theta$,
es posible expresar el sistema con una única 
coordenada generalizada $\mathbf q = \theta$.
De igual manera el momento generalizado $\mathbf p$ está dado por \eqref{eq: generalized momentum}.

\begin{equation}
\begin{split}
 \mathbf p & = p_{\theta}\\
 p_{\theta} &= \dfrac{\partial \mathcal L}{\partial \dot \theta}\\
 &= m l^2 \dot \theta 
\end{split}
\label{eq: theta momentum}
\end{equation}

Substituyendo \eqref{eq: theta momentum} en 
\eqref{eq: hamiltonian} se obtiene el Hamiltoniano del sistema.

\begin{equation}
 \begin{split}
  \mathcal H & = p_{\theta} \dot \theta - \mathcal L \\
  & = m l^2 \dot \theta ^2 - (\dfrac{1}{2}m l^2 \dot{\theta}^2 - m g l (1 - \cos{\theta}))\\
  & = \dfrac{1}{2}m l^2 \dot{\theta}^2 + m g l (1 - \cos{\theta})
 \end{split}
 \label{eq: hamiltonian pendulum}
\end{equation}

De \eqref{eq: theta momentum} es posible expresar $\dot \theta$ como una función del momento generalizado.

\begin{equation}
 \dot \theta = \dfrac{p_{\theta}}{m l^2}
 \label{eq: dtheta hamiltonian}
\end{equation}

Substituyendo \eqref{eq: dtheta hamiltonian} en 
\eqref{eq: hamiltonian pendulum} se obtiene una nueva 
expresión del Hamiltoniano.

\begin{equation}
 \mathcal H = \dfrac{1}{2} \dfrac{p_{\theta}^2}{m l^2}  + m g l (1 - \cos{\theta})
 \label{eq: ptheta hamiltonian}
\end{equation}

Se obtienen las funciones para $\dot p_{\theta}$ y 
$\dot \theta$ de las derivadas parciales del Hamiltonianio.

\begin{subequations}
\begin{align}
\dot p_{\theta} &= - \dfrac{\partial \mathcal H}{\partial \theta}\\
&= -mgl \sin \theta \\
\dot \theta &= \dfrac{\partial \mathcal H}{\partial p_{\theta}}\\
&= \dfrac{p_{\theta}}{ml^2}
\end{align}

\end{subequations}
